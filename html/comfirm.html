<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="../css/animate.css"/>
</head>
<style>
    * {
        font-family: "Helvetica Neue",Helvetica,"Hiragino Sans GB","Microsoft YaHei",Arial,sans-serif;
    }
    h1,h2,h3,h4,h5,h6 {margin: 0; padding: 0;}
    .l-dialog {
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        z-index: 1050;
        overflow: hidden;
        outline: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.5);
        -webkit-overflow-scrolling: touch;
    }
    .l-dialog-box {
        position: relative;
        width: 550px;
        margin-left: auto;
        margin-right: auto;
        margin-top: 40px;
        color: #535e66;
        background-color: #ffffff;
        position: relative;
        overflow: hidden;


        -webkit-background-clip: padding-box;
        background-clip: padding-box;
        border: 1px solid #999;
        border: 1px solid rgba(0,0,0,.2);
        border-radius: 5px;
        outline: 0;
        -webkit-box-shadow: 0 3px 9px rgba(0,0,0,.5);
        box-shadow: 0 3px 9px rgba(0,0,0,.5);

        animation-duration: 1s;
        animation-timing-function: ease;
    }
    .fadeOut {
        animation-duration: .5s;
    }
    .fadeOutUp {
        animation-duration: .5s;
    }
    .l-dialog-title {
        height: 16px;
        padding: 15px;
        border-bottom: 1px solid #e5e5e5;
        position: relative;
    }
    .l-dialog-c {
        background: url("../img/comfirm/lala.png") no-repeat -30px 2px;
        height: 20px;
        width: 20px;
        position: absolute;
        right: 15px;
        top: 15px;
        cursor: pointer;
    }
    .l-dialog-content {
        min-height: 16px;
        padding: 15px;
    }
    .l-dialog-footer {
        height: 34px;
        padding: 15px;
        border-top: 1px solid #e5e5e5;
        text-align: center;
    }
    .tc {
        text-align: center;
    }
    .btn {
        display: inline-block;
        padding: 6px 12px;
        margin-bottom: 0;
        font-size: 14px;
        font-weight: 400;
        line-height: 1.42857143;
        text-align: center;
        white-space: nowrap;
        vertical-align: middle;
        -ms-touch-action: manipulation;
        touch-action: manipulation;
        cursor: pointer;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        background-image: none;
        border: 1px solid transparent;
        border-radius: 3px;
        margin: 0 5px;
    }
    .btn-default {
        color: #333;
        background-color: #fff;
        border-color: #ccc;
    }
    .btn-primary {
        color: #fff;
        background-color: #337ab7;
        border-color: #2e6da4;
    }
    .btn-error {
        color: #fff;
        background-color: #d9534f;
        border-color: #d43f3a;
    }
    .btn-success {
        color: #fff;
        background-color: #56BD9D;
        border-color: #4EA288;
    }
    .btn-info {
        color: #fff;
        background-color: #52B1CE;
        border-color: #3898B5;
    }
    .btn-warning {
        color: #fff;
        background-color: #f0ad4e;
        border-color: #eea236;
    }
    .btn-error:hover {
        color: #fff;
        background-color: #c9302c;
        border-color: #ac2925;
    }
    .btn-success:hover {
        color: #fff;
        background-color: #479C82;
        border-color: #469079;
    }
    .btn-warning:hover {
        color: #fff;
        background-color: #ec971f;
        border-color: #d58512;
    }
    .btn-default:hover {
        color: #333;
        background-color: #e6e6e6;
        border-color: #adadad;
    }
    .btn-info:hover {
        color: #fff;
        background-color: #2491B1;
        border-color: #20809C;
    }
    .btn-primary:hover {
        color: #fff;
        background-color: #286090;
        border-color: #204d74;
    }


    .l-tip-info {
        /*display: flex;*/
        /*align-items: center;*/
        /*justify-content: center;*/


        min-height: 75px;
        text-align: left;

    }
    .l-tip-info-img {
        height: 52px;
        width: 52px;
        display: inline-block;
        vertical-align: middle;
        margin-bottom: 10px;
    }
    .l-success {
        background: url("../img/comfirm/lala.png") no-repeat -14px -61px;
    }
    .l-warning {
        background: url("../img/comfirm/lala.png") no-repeat -14px -13px;
        height: 48px;
    }
    .l-question {
        background: url("../img/comfirm/lala.png") no-repeat -70px -10px;
    }
    .l-close {
        background: url("../img/comfirm/lala.png") no-repeat -70px -61px;
    }
    .l-tip-info-fonts {
        text-align: left;
        display: inline-block;
        vertical-align: super;
        line-height: 24px;
        margin-left: 10px;
        /*flex: 1;*/
    }

    [class^=c-] {
        height: 30px;
        width: 150px;
        border: 1px solid lightgray;
        background: #049cdb;
    }
</style>
<body>
<div class="container">
    <p>123123</p>
    <div class="c-1">123</div>
    <div class="c-2">234</div>
    <code>
        var function() {
            console.log(12);
        }
    </code>
</div>
<div class="l-dialog animated fadeIn" style="display: none;">
    <div class="l-dialog-box animated fadeInDown">
        <div class="l-dialog-title">
            <h4 class="l-dialog-t">这是title</h4>
            <i class="l-dialog-c"></i>
        </div>
        <div class="l-dialog-content tc">
            <span class="l-tip-info">
                <span class="l-tip-info-img l-success"></span>
                <span class="l-tip-info-fonts">
                    这里是一段提示信息的话,这里是一段提示信息的话
                    <!--这里是一段提示信息的话,这里是一段提示信息的话-->
                    <!--这里是一段提示信息的话,这里是一段提示信息的话-->
                </span>
            </span>
        </div>
        <div class="l-dialog-footer">
            <div class="btn btn-default">取消</div>
            <div class="btn btn-success">确定</div>
        </div>
    </div>
</div>
</body>
<script src="../js/lib/jquery.min.js"></script>
<script src="../js/comfirm/comfirm.js"></script>
<script>
    $(function() {
//        $('.dialog').not($('.dialog-box')).on('click', function() {
//            console.log(123);
//            event.stopPropagation();
//        });

//        $(".dialog").on('click', function(e){
//            var _target = $(e.target);
//            if (_target.closest(".dialog-box").length == 0) {
//                $(".dialog").off();
//
//            }
//        });

//        $('.l-dialog').click(function() {
//            $('.l-dialog').removeClass('fadeIn').addClass('fadeOut');
//            $('.l-dialog-box').removeClass('fadeInDown').addClass('fadeOutUp');
//        });
//
//        $('.l-dialog-box').on('click' ,function(event) {
//            event.stopPropagation();
//        });


        $('.l-dialog-close').click(function() {
            $('.l-dialog').removeClass('fadeIn').addClass('fadeOut');
            $('.l-dialog-box').removeClass('fadeInDown').addClass('fadeOutUp');
        });


        $('.right-grad-edit').on('click', function() {
            if($('.select-alter-p-i').hasClass('on')) {
                $('.select-alter-p-i').removeClass('on');

            } else {
                $('.select-alter-p-i').addClass('on');
                $(document).not($('.select-alter-p-i')).one('click', function() {
                    $('.select-alter-p-i').removeClass('on');
                });
            }
            event.stopPropagation();
        });


//        三个参数： appHtml, config, type
//        appHtml: 必填，字符串数据格式，用来显示弹窗的内容
//        config: 选填，对象数据格式，用来配置基本信息
//        type: 选填，对象或字符串，用来配置title和按钮组

        $('.c-1').on('click', function() {
            var dialog = new LDialog("test2", {footer: false}, {btn: {sure: "btn-info"}});
            dialog.init();
        });

        $('.c-2').on('click', function() {
            con = {
                onSure: function(v) {
                    alert(v);
                }
            };

            var dialog2 = new LDialog("test", con, "input");
            dialog2.init();
        });
    });


    var allType;

    function LDialog(appHtml ,config, type) {
        this.appHtml = appHtml || "";
        this.config = config || {};
        this.type = type || {};
        this.createId;
    }

    LDialog.prototype.init = function() {
        var popType = {
            info: {
                title: "信息",
                btn: {
                    sure: "btn-info",
                    cancel: "btn-default"
                },
                iconClass: "l-success"
            },
            success: {
                title: "成功",
                btn: {
                    sure: "btn-success",
                    cancel: "btn-default"
                },
                iconClass: "l-success"
            },
            error: {
                title: "错误",
                btn: {
                    sure: "btn-error",
                    cancel: "btn-default"
                },
                iconClass: "l-close"
            },
            confirm: {
                title: "提示",
                btn: {
                    sure: "btn-warning",
                    cancel: "btn-default"
                },
                iconClass: "l-question"
            },
            input: {
                title: "输入",
                btn: {
                    sure: "btn-primary",
                    cancel: "btn-default"
                }
            },
            custom: {
                title: "弹窗",
                btn: {}
            }
        };

        
        var initType = this.type instanceof Object ? this.type : popType[this.type] || {};//格式化输入的参数:弹窗类型

        var initConfig = $.extend(true, {
            btn: {},
            sureTitle: "确定",
            cancelTitle: "取消",
            title: "", //标题
            footer: true, //按钮组
            icon: true, //图标
            iconClass: "",
            minHeight: "50px", //最小高度
            width: "550px",
            onSure: $.noop,//点击确定的按钮回调
            onCancel: $.noop,//点击取消的按钮回调
            onClose: $.noop//弹窗关闭的回调,返回触发事件
        }, initType, this.config);

        this.createHtml(initConfig);
        allType = initConfig;
    };

    LDialog.prototype.createHtml = function(config) {
        //创建icon和content元素
        var $txt = $("<span>").addClass('l-tip-info-fonts').html(this.appHtml);
        var $icon = config.iconClass !== ""  || config.cion ? $("<span>").addClass('l-tip-info-img').addClass(config.iconClass) : "";
        //创建叉叉关闭和标题元素
        var $close = $('<i class="l-dialog-c">');
        var $title = $('<h4 class="l-dialog-t">').html(config.title);
        //创建确定和取消按钮元素
        var $sure = config.btn.sure ? $('<div>').addClass("btn").addClass(config.btn.sure).text(config.sureTitle) : $('<div>');
        var $cancel = config.btn.cancel ? $('<div>').addClass("btn").addClass(config.btn.cancel).text(config.cancelTitle) : $('<div>');
        //创建footer元素，判断是否显示footer
        var $footer = config.footer ? $('<div class="l-dialog-footer">') : $('<div class="l-dialog-footer" style="display: none!important"></div>');
        //创建内容盒子元素
        var $contentBox = $('<div class="l-dialog-content tc"></div>');
        var $contentBoxIn = $('<span class="l-tip-info"></span>');
        var $headerBox = $('<div class="l-dialog-title"></div>');
        var $dialogBox = $('<div>').addClass("l-dialog-box animated fadeInDown").css({
            'width': config.width,
            'min-height': config.minHeight
        });
        var $dialog = $('<div>').addClass("l-dialog animated fadeIn");

        var sendObj = {
            txt: $txt,
            icon: $icon,
            close: $close,
            title: $title,
            sure: $sure,
            cancel: $cancel,
            footer: $footer,
            contentBox: $contentBox,
            contentBoxIn: $contentBoxIn,
            headerBox: $headerBox,
            dialogBox: $dialogBox,
            dialog: $dialog
        };
        this.createBom(sendObj);
        this.addListener(sendObj);
    };

    LDialog.prototype.createBom = function(accObj) {
        this.createId = this.createId();

        accObj.dialog.attr('id', this.createId).append(
            accObj.dialogBox.append(
                accObj.headerBox.append(
                    accObj.title
                ).append(
                    accObj.close
                )
            ).append(
                accObj.contentBox.append(
                    accObj.contentBoxIn.append(
                        accObj.icon
                    ).append(
                        accObj.txt
                    )
                )
            ).append(
                accObj.footer.append(
                    accObj.cancel
                ).append(
                    accObj.sure
                )
            )
        );

        $('body').append(accObj.dialog);
        $('body').blur();
    };

    //重生popId,防止id重复
    LDialog.prototype.createId = function() {
        var id =  "pop-" + new Date().getTime() + parseInt(Math.random()*100000); //弹窗索引

        if($("#" + id).length > 0) {
            return this.creatPopId();
        } else {
            return id;
        }
    };

    LDialog.prototype.addListener = function(accObj) {
        var dia_id = {id : this.createId};

        accObj.close.on('click', dia_id, this.close);

        accObj.cancel.on('click', dia_id, this.cancel);

        accObj.sure.on('click', dia_id , this.sure);

        $(window).on('keydown', dia_id, this.enter);
    };

    //叉叉按钮关闭弹窗
    LDialog.prototype.close = function(event) {
        var dia_id = event.data.id;

        LDialog.addOrRemoveClass(dia_id);

        setTimeout(function() {
            $('#' + dia_id).remove();
            allType.onClose();
        }, 500);
    };

    //取消按钮关闭弹窗
    LDialog.prototype.cancel = function(event) {
        var dia_id = event.data.id;

        LDialog.addOrRemoveClass(dia_id);

        setTimeout(function() {
            $('#' + dia_id).remove();
            allType.onCancel();
        }, 500)
    };

    //确定按钮关闭弹窗
    LDialog.prototype.sure = function(event) {
        var input = "test value";
        var dia_id = event.data.id;

        LDialog.addOrRemoveClass(dia_id);

        setTimeout(function() {
            $('#' + dia_id).remove();
            allType.onSure(input);
        }, 500)
    };

    //回车键确认事件
    LDialog.prototype.enter = function(event) {
        var dia_id = event.data.id;

        if(event.keyCode === 13) {
            if($("#" + dia_id).length === 1){
                LDialog.keySure(dia_id);
            }
        }
    };

    LDialog.keySure = function(dia_id) {
        var input = "test value";

        LDialog.addOrRemoveClass(dia_id);
        setTimeout(function() {
            $('#' + dia_id).remove();
            allType.onSure(input);
        }, 500)
    };

    LDialog.addOrRemoveClass = function(dia_id) {
        $('#' + dia_id).removeClass('fadeIn').addClass('fadeOut');
        $('#' + dia_id).find('.l-dialog-box').removeClass('fadeInDown').addClass('fadeOutUp');
    }

</script>
</html>